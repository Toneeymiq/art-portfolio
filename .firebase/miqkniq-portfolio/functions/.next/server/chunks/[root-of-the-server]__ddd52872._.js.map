{"version":3,"sources":["../../../lib/cache.ts"],"sourcesContent":["// Simple in-memory cache for reducing Firestore reads\n// This helps keep costs low by caching frequently accessed data\n\ninterface CacheEntry<T> {\n    data: T;\n    timestamp: number;\n    ttl: number; // Time to live in milliseconds\n}\n\nclass SimpleCache {\n    private cache: Map<string, CacheEntry<unknown>> = new Map();\n\n    set<T>(key: string, data: T, ttlMs: number = 5 * 60 * 1000): void {\n        this.cache.set(key, {\n            data,\n            timestamp: Date.now(),\n            ttl: ttlMs,\n        });\n    }\n\n    get<T>(key: string): T | null {\n        const entry = this.cache.get(key);\n        if (!entry) return null;\n\n        // Check if expired\n        if (Date.now() - entry.timestamp > entry.ttl) {\n            this.cache.delete(key);\n            return null;\n        }\n\n        return entry.data as T;\n    }\n\n    invalidate(key: string): void {\n        this.cache.delete(key);\n    }\n\n    invalidatePrefix(prefix: string): void {\n        for (const key of this.cache.keys()) {\n            if (key.startsWith(prefix)) {\n                this.cache.delete(key);\n            }\n        }\n    }\n\n    clear(): void {\n        this.cache.clear();\n    }\n}\n\n// Singleton instance\nexport const cache = new SimpleCache();\n\n// Cache keys\nexport const CACHE_KEYS = {\n    SETTINGS: 'settings',\n    ARTWORKS: 'artworks',\n    ARTWORKS_PUBLISHED: 'artworks:published',\n    POSTS: 'posts',\n    POSTS_PUBLISHED: 'posts:published',\n    PROCESS: 'process',\n    STAFF: 'staff',\n};\n\n// Cache TTL values (in milliseconds)\nexport const CACHE_TTL = {\n    SETTINGS: 10 * 60 * 1000,    // 10 minutes - settings rarely change\n    ARTWORKS: 5 * 60 * 1000,     // 5 minutes\n    POSTS: 5 * 60 * 1000,        // 5 minutes\n    PROCESS: 5 * 60 * 1000,      // 5 minutes\n    STAFF: 10 * 60 * 1000,       // 10 minutes\n    DEFAULT: 3 * 60 * 1000,      // 3 minutes default\n};\n"],"names":[],"mappings":"i/BASA,OAAM,EACM,MAA0C,IAAI,GAAM,CAE5D,IAAO,CAAW,CAAE,CAAO,CAAE,EAAgB,GAAa,CAAT,AAAiB,CAC9D,IADkD,AAC9C,CAAC,KAAK,CAAC,GAAG,CAAC,EAAK,MAChB,EACA,UAAW,KAAK,GAAG,GACnB,IAAK,CACT,EACJ,CAEA,IAAO,CAAW,CAAY,CAC1B,IAAM,EAAQ,IAAI,CAAC,KAAK,CAAC,GAAG,CAAC,UACxB,AAAL,EAGI,EAHA,GAAQ,AAGH,GAAG,GAAK,EAAM,SAAS,CAAG,EAAM,GAAG,EAAE,AAC1C,IAAI,CAAC,KAAK,CAAC,MAAM,CAAC,GACX,MAGJ,EAAM,IAAI,CARE,IASvB,CAEA,WAAW,CAAW,CAAQ,CAC1B,IAAI,CAAC,KAAK,CAAC,MAAM,CAAC,EACtB,CAEA,iBAAiB,CAAc,CAAQ,CACnC,IAAK,IAAM,KAAO,IAAI,CAAC,KAAK,CAAC,IAAI,GAAI,AAC7B,EAAI,UAAU,CAAC,IACf,IAAI,CADoB,AACnB,KAAK,CAAC,MAAM,CAAC,EAG9B,CAEA,OAAc,CACV,IAAI,CAAC,KAAK,CAAC,KAAK,EACpB,CACJ,CAGO,IAAM,EAAQ,IAAI,sBAGC,CACtB,SAAU,WACV,SAAU,WACV,mBAAoB,qBACpB,MAAO,QACP,gBAAiB,kBACjB,QAAS,UACT,MAAO,OACX,gBAGyB,CACrB,SAAU,IACV,CADe,KAAK,GACV,IAAI,AACd,KADmB,CACZ,IAAI,AACX,KADgB,GACP,IAAI,AACb,KADkB,CACX,IACP,CADY,KAAK,EACR,IAAI,AACjB,KADsB"}